<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Latest Courses</title>
  <style>
    * {
      margin: 0; padding: 0; box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: white
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: auto;
    }

    .header {
      text-align: left;
      margin-bottom: 30px;
      color: rgb(0, 0, 0);
    }

    .header h1 {
      font-size: 2rem;
      margin-bottom: 8px;
      margin-top: 30px;
    }


    .refresh-btn {
      background: #004e5a;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 20px;
      cursor: pointer;
      font-weight: bold;
      display: block;
      margin-bottom: 8px;
      margin-top: 30px;
    }

    .course-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 20px;
    }

    .card-link {
      text-decoration: none;
      color: inherit;
      height: 100%;
      display: block;
    }

    .course-card {
      background: #ffffffee;
      border-radius: 15px;
      padding: 15px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      display: flex;
      flex-direction: column;
      height: 100%;
      transition: transform 0.3s ease;
    }

    .course-card:hover {
      transform: translateY(-5px);
    }

    .course-card img {
      width: 100%;
      height: 180px;
      object-fit: cover;
      border-radius: 10px;
      margin-bottom: 12px;
    }

    .course-title {
      font-size: 1.2rem;
      font-weight: bold;
      margin-bottom: 5px;
      color: #2c3e50;
    }

    .course-id {
      font-size: 0.85rem;
      color: #555;
      margin-bottom: 10px;
    }

    .course-summary {
      font-size: 0.9rem;
      color: #555;
      margin-top: auto;
      max-height: 70px;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .loading, .error {
      text-align: center;
      color: white;
      font-size: 1rem;
      padding: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üìö Check our new course!!</h1>
    </div>
    <div id="courseContainer">
      <div class="loading">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≠‡∏£‡πå‡∏™...</div>
    </div>
    <button class="refresh-btn" onclick="loadCourses()">üîÑ ‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏´‡∏°‡πà</button>
  </div>

  <script>
    const API_URL = "https://gdacademy.goldenduckgroup.com/moodle/webservice/rest/server.php?wstoken=f4dcacd0522b9bb7c5d9aeebf35041e5&wsfunction=core_course_get_courses&moodlewsrestformat=json";

    const images = [
      "https://raw.githubusercontent.com/Hamkwargs/new-course-widget/main/image/cover-1.png",
      "https://raw.githubusercontent.com/Hamkwargs/new-course-widget/main/image/cover-3.png"
    ];

    async function loadCourses() {
      const container = document.getElementById("courseContainer");
      container.innerHTML = '<div class="loading">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≠‡∏£‡πå‡∏™...</div>';

      try {
        const response = await fetch(API_URL);
        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
        const data = await response.json();

        const courses = data
          .filter(c => c.id > 1)
          .sort((a, b) => b.id - a.id)
          .slice(0, 3);

        const grid = document.createElement("div");
        grid.className = "course-grid";

        courses.forEach((course, index) => {
          const img = images[index % images.length];

          const card = document.createElement("a");
          card.href = `https://gdacademy.goldenduckgroup.com/moodle/course/view.php?id=${course.id}`;
          card.className = "card-link";
          card.target = "_top";

          card.innerHTML = `
            <div class="course-card">
              <img src="${img}" alt="Course Image"
                   onerror="this.onerror=null;this.src='https://via.placeholder.com/640x360?text=Image+Not+Found';">
              <div class="course-title">${course.fullname || course.shortname}</div>
              <div class="course-id">ID: ${course.id} | ${course.shortname}</div>
              ${course.summary ? `<div class="course-summary">${course.summary}</div>` : ''}
            </div>
          `;

          grid.appendChild(card);
        });

        container.innerHTML = "";
        container.appendChild(grid);
      } catch (err) {
        container.innerHTML = `<div class="error">‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${err.message}</div>`;
      }
    }

    window.addEventListener("load", loadCourses);
  </script>
</body>
</html>
